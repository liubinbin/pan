# chunk设计

chunk是实际存储数据的地方，其实就是一块大的内存。我们预先申请一块大内存，然后将KeyValue放在此chunk中，chunk这种申请方式可以有效的减少gc影响。chunk按segmentSize划分成多个segment。在一个chunk中，segment的大小是相同的。这种方式可以比较好的回收内存，比如我们删除了一个KeyValue，如果segment是相同的，我们就可以像原来加数据时那样把这块内存利用起来。当然我们可能会浪费一部分内存，但这个是为了支持delete操作需要做的。

当然另外lsm架构可以消除这种操作，我们可以不支持删除，只是添加一个key相关的删除标志来达到删除目的，在compact之后我们可以回收这部分内存。